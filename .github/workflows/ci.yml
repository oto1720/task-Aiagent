name: CI

# いつ実行するか？
on:
  push:
    branches: [ main ]  # mainブランチにpushした時だけ
  pull_request:
    branches: [ main ]

jobs:
  # ジョブ名（わかりやすい名前）
  check-my-code:
    runs-on: ubuntu-latest
    timeout-minutes: 10  # 10分でタイムアウト（無料枠節約）
    
    steps:
    # ステップ1: コードをダウンロード
    - name: 📥 コードをダウンロード
      uses: actions/checkout@v4
    
    # ステップ2: Flutter環境を準備
    - name: 🛠️ Flutter準備
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.35.3'
        cache: true  # 次回から早くなる
        
    # ステップ3: 必要なパッケージをダウンロード
    - name: 📦 パッケージ取得
      run: flutter pub get
      
    # ステップ4: コードに問題がないかチェック
    - name: 🔍 コードチェック
      run: flutter analyze
      
    # ステップ5: テストを実行
    - name: 🧪 テスト実行
      run: flutter test
      
    # ステップ6: 成功メッセージ
    - name: ✅ 完了
      run: |
        echo "🎉 すべてのチェックが完了しました！"
        echo "📱 アプリに問題はありません"